{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/engine.ts","webpack:///./src/entities/observer.ts","webpack:///./src/helpers/sprite.ts","webpack:///./src/helpers/task.ts","webpack:///./src/helpers/task-queue.ts","webpack:///./src/helpers/animation.ts","webpack:///./src/helpers/animator.ts","webpack:///./src/helpers/npc.ts","webpack:///./src/helpers/delay.ts","webpack:///./src/helpers/screen.ts","webpack:///./src/entities/player.ts","webpack:///./src/entities/camera.ts","webpack:///./src/data/index.ts","webpack:///./src/entities/level.ts","webpack:///./src/entities/input.ts","webpack:///./src/entities/npc-manager.ts","webpack:///./src/entities/dialogue.ts","webpack:///./src/entities/battle/battle-component.ts","webpack:///./src/entities/battle/hp.ts","webpack:///./src/entities/battle/ui.ts","webpack:///./src/entities/battle/player-ui.ts","webpack:///./src/entities/battle/enemy-ui.ts","webpack:///./src/entities/battle/fighter.ts","webpack:///./src/entities/battle/player-fighter.ts","webpack:///./src/entities/battle/enemy-fighter.ts","webpack:///./src/entities/battle/backdrop.ts","webpack:///./src/entities/battle/arena.ts","webpack:///./src/entities/battle/index.ts","webpack:///./src/entities/battle/battle.ts","webpack:///./src/entities/transition.ts","webpack:///./src/entities/sound.ts","webpack:///./src/entities/loading-screen.ts","webpack:///./src/index.ts","webpack:///./src/game.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Engine","constructor","taskQueue","this","_observers","_intervalId","_taskQueue","addObserver","observer","push","removeObserver","filter","loop","isTaskAvailable","forEach","update","currentTask","endCurrentTask","start","window","setInterval","stop","clearInterval","init","Observer","task","_acceptedTasks","has","handleUpdate","Sprite","path","grid","sheet","width","height","Promise","resolve","reject","image","Image","src","onload","onerror","imageWidth","imageHeight","loadImageData","columns","rows","x","Task","action","TaskQueue","_tasks","addTask","shift","Animation","speed","getAnimatedElement","_name","_sheet","_speed","_animatedElement","play","spriteCounter","length","y","style","backgroundPosition","Animator","animatedElement","_animations","addAnimation","animation","Error","NPC","currentFacingPosition","sprite","_currentFacingPosition","domElement","hasBattled","handleMovement","direction","left","top","npcPositionOnDOM","up","down","right","setNPCPositionOnDom","ejectFromDom","remove","faceTowardsPlayer","setFacingPosition","Number","substring","setFacingPositions","_npcFacingPositions","createElement","element","document","backgroundImage","backgroundRepeat","position","transition","setInitialPositionOnDom","startingPosition","positionOnDOM","_position","Delay","time","setTimeout","Screen","root","_root","_width","_height","adjustScreen","currentTarget","innerHeight","innerWidth","calculatedHeight","calculatedWidth","transform","addEventListener","Player","currentLevel","isSceneTransition","getSceneTransition","isInteraction","getInteraction","isSpaceWalkable","super","animator","_currentLevel","_storedBackgroundPositions","Set","_playerFacingPositions","handleSceneTransitionStart","handleInteraction","resetGym","getTargetedPosition","updatePositionOnDOM","playerPositionOnDOM","playerPosition","playerFacingPosition","level","setPlayerPositionOnDom","interaction","type","debug","className","dataset","toString","getElementById","append","createAnimations","Camera","backgroundElement","isDebugMode","_visibleWidth","_visibleHeight","_collisionWidth","_collisionHeight","_playerBoundaries","_isDebugMode","_player","_backgroundElement","_cameraPosition","maxLeft","maxRight","maxTop","maxBottom","selectedMovement","moveCamera","currentBackgroundPosition","backgroundPositionOnDOM","backgroundPositionX","backgroundPositionY","border","boxSizing","player","levels","home","pokemonCenter","gymEntrance","battleTower","lfzEntrance","casino","casinoRoom","homeHouse1","homeHouse2","homeHouse3","gymArena1PreBattle","gymArena2PreBattle","gymArena3PreBattle","gymArena4PreBattle","gymArena5PreBattle","gymArena1PostBattle","gymArena2PostBattle","gymArena3PostBattle","gymArena4PostBattle","gymArena5PostBattle","gymArena6","Level","triggerDebugView","changeGrid","changeMap","getTile","sceneTransition","isWalkable","tile","textContent","gridName","shiftBackgroundPosition","filePaths","values","map","all","loadBackgroundImages","playerSpawnPoint","backgroundSpawnPoint","Input","_isDisabled","_isWalking","_currentMode","_movementKeys","_keyTable","loading","walking","dialogue","battle","bool","handleSceneTransitionEnd","handleNPCInteractionStart","handleNPCInteractionEnd","handleBattleStart","handleBattleNavigateAnswer","handleDisableInput","handleEnableInput","handleSimulateInput","handleStartGame","handleInput","isDisabled","keyTable","startWalkingLoop","handleWalkingLogic","stopWalkingLoop","_walkingInterval","NPCManager","_npcs","npcData","npcs","handleNPCMovement","find","npc","switchLevel","npcElements","newLevel","files","filesCombined","f","facingPosition","Dialogue","_currentDialogue","_writingIntervalId","_currentWritingText","_dialogues","dialogueData","_isShowing","containerElement","headingElement","contentElement","handleDialogue","handleNPCBattleEnd","hide","heading","content","join","text","isTrigger","Array","isArray","a","split","writeText","postBattle","preBattle","show","letter","Uzair","isShowing","bottom","opacity","container","borderRadius","backgroundColor","zIndex","fontSize","paddingLeft","headingLine","margin","padding","BattleComponent","HP","isPlayer","_health","_damage","_classBase","_movingPosition","_healthBarContainer","querySelector","_healthBar","firstElementChild","setDamageCounter","damage","reset","UI","_uiContainer","PlayerUI","_answerElements","querySelectorAll","_selectedAnswer","setCorrect","classList","add","setWrong","resetSelection","removeSelectedClass","addSelectedClass","setAnswers","answers","selectNextAnswer","selectPreviousAnswer","EnemyUI","_content","message","Fighter","_characterContainer","blinks","intervalId","PlayerFighter","EnemyFighter","_selectedBackgroundPosition","_sprite","_fighterBackgrounds","then","Brett","Scott","Christian","TimD","TimH","Sarah","Cody","Blake","set","BackDrop","_backDropElement","Arena","_arenaElement","_arenaBackgrounds","normal","rock","dirt","ghost","grass","water","psychic","ocean","ice","plant","arena","Battle","_battleData","battleData","_currentLevelQuestionData","_currentQuestions","_selectedQuestionData","_battleComponents","backdrop","enemyFighter","enemyUI","playerFighter","playerUI","playerHP","enemyHP","handleBattleEnd","handleBattle","wasLoss","delay","component","isCorrect","selectedAnswer","_currentQuestion","correct","isDead","winningMessage","losingMessage","onWin","onLoss","isLow","question","fighter","questions","generalQuestions","shuffleQuestions","background","damageToEnemy","damageToPlayer","title","openingMessage","randomNum","Math","floor","random","placeHolder","loadPlayerUI","beginQuestion","loadHealthBars","showOpeningMessage","showStartingMessage","loadEnemyUI","loadInCharacters","setupBattleBackground","setupBackdrop","Transition","_domElement","Sound","_path","_sounds","_isMuted","volume","stopAllSounds","pause","currentTime","handleToggleSound","handleBattleDamage","handleBattleHealthLow","handleSelect","handleWallBump","playMapSound","wall","select","battleDamage","lowHealth","sound","isMuted","some","doorEnter","file","isLooping","audio","Audio","onloadeddata","sounds","loadSound","reduce","LoadingScreen","_container","_message","$root","loadingScreen","engine","npcManager","camera","input","screen","setupDOM","args","playerElement","loadNPCImages","cameraElement","dialogueElement"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n","import { Observer } from './entities'\r\nimport { TaskQueue } from './helpers'\r\n\r\nexport default class Engine {\r\n  private _observers: Array<Observer>\r\n  private _intervalId: number\r\n  private _taskQueue: TaskQueue\r\n  constructor(taskQueue: TaskQueue) {\r\n    this._observers = []\r\n    this._intervalId = null\r\n    this._taskQueue = taskQueue\r\n  }\r\n  addObserver(observer: Observer): void {\r\n    this._observers.push(observer)\r\n  }\r\n  removeObserver(observer: Observer): void {\r\n    this._observers = this._observers.filter(o => o !== observer)\r\n  }\r\n  loop(): void {\r\n    if(!this._taskQueue.isTaskAvailable) return\r\n    this._observers.forEach(o => o.update(this._taskQueue.currentTask))\r\n    this._taskQueue.endCurrentTask()\r\n  }\r\n  start(): void {\r\n    this._intervalId = window.setInterval(this.loop.bind(this), 1000/60)\r\n  }\r\n  stop(): void {\r\n    clearInterval(this._intervalId)\r\n  }\r\n  init(): void {\r\n    this.start()\r\n  }\r\n}\r\n","import { Task } from \"../helpers\"\r\n\r\nexport abstract class Observer {\r\n  public _acceptedTasks: Set<string>\r\n  abstract handleUpdate (task: Task): void\r\n\r\n  update(task: Task): void {\r\n    if (!this._acceptedTasks.has(task.name)) return\r\n    this.handleUpdate(task)\r\n  }\r\n}\r\n","export class Sprite {\n  public name: string\n  public path: string\n  public grid: number[]\n  public sheet: number[][]\n  public width: number\n  public height: number\n  constructor(name: string, path: string, grid: number[]) {\n    this.name = name\n    this.path = path\n    this.grid = grid\n    this.sheet = null\n    this.width = null\n    this.height = null\n  }\n  async loadImageData(): Promise<number[]> {\n    return new Promise((resolve, reject) => {\n      const image = new Image()\n      image.src = this.path\n      image.onload = () => resolve([image.width, image.height])\n      image.onerror = reject\n    })\n  }\n  async init(): Promise<void> {\n    const [imageWidth, imageHeight] = await this.loadImageData()\n    const [columns, rows] = this.grid\n    const sheet = []\n    this.width = imageWidth / columns\n    this.height = imageHeight / rows\n    for(let x = 0; x < columns; x++) {\n      for (let i = 0; i < rows; i++) {\n        sheet.push([-(x * this.width), -(i * this.height)])\n      }\n    }\n    this.sheet = sheet\n  }\n}\n","export class Task {\r\n  public name: string\r\n  public action: any\r\n  constructor(name: string, action: any = null) {\r\n    this.name = name\r\n    this.action = action\r\n  }\r\n}\r\n","import { Task } from \"./\"\n\nexport class TaskQueue {\n  private _tasks: Array<Task>\n  constructor() {\n    this._tasks = []\n  }\n  get currentTask () {\n    return this._tasks[0] || null\n  }\n  get isTaskAvailable () {\n    return !!this._tasks[0]\n  }\n  addTask(task: Task): void {\n    this._tasks.push(task)\n  }\n  endCurrentTask(): void {\n    this._tasks.shift()\n  }\n}\n","export class Animation {\n  private _name: string\n  private _sheet: number[][]\n  private _speed: number\n  private _intervalId: number\n  private _animatedElement: HTMLElement\n  constructor(name: string, sheet: number[][], speed: number, getAnimatedElement: HTMLElement) {\n    this._name = name\n    this._sheet = sheet\n    this._speed = speed\n    this._intervalId = null\n    this._animatedElement = getAnimatedElement\n  }\n  play(): void {\n    clearInterval(this._intervalId)\n    let spriteCounter = 0\n    this._intervalId = window.setInterval(() => {\n      if(spriteCounter === this._sheet.length) return clearInterval(this._intervalId)\n      const [x, y] = this._sheet[spriteCounter]\n      this._animatedElement.style.backgroundPosition = `${x}px ${y - 24}px`\n      spriteCounter++\n    }, this._speed)\n  }\n}\n","import { Animations } from \"../interfaces/animations\"\nimport { Animation } from './animation'\n\nexport class Animator {\n  private _animations: Animations\n  private _animatedElement: HTMLElement\n  constructor(animatedElement: HTMLElement) {\n    this._animations = {}\n    this._animatedElement = animatedElement\n  }\n  get animatedElement(): HTMLElement {\n    return this._animatedElement\n  }\n  addAnimation(name: string, sheet: number[][], speed: number): void {\n    const animation = new Animation(name, sheet, speed, this.animatedElement)\n    this._animations[name] = animation\n  }\n  play(name: string): void {\n    if(!this._animations[name]) throw new Error(`Missing Animation named ${name}`)\n    this._animations[name].play()\n  }\n}\n","import { Movements, PlayerFacingPositions, Position} from \"../interfaces\";\r\nimport { Sprite } from \".\";\r\n\r\nexport class NPC {\r\n  public name: string\r\n  public sprite: Sprite\r\n  public domElement: HTMLElement\r\n  public width: number\r\n  public height: number\r\n  private hasBattled: boolean\r\n  private _position: Position\r\n  private _npcFacingPositions: PlayerFacingPositions\r\n  private _currentFacingPosition: keyof PlayerFacingPositions\r\n  constructor(\r\n    name: string,\r\n    path: string,\r\n    currentFacingPosition: keyof PlayerFacingPositions\r\n  ) {\r\n    this.name = name\r\n    this.sprite = new Sprite(name, path, [4, 1])\r\n    this._currentFacingPosition = currentFacingPosition\r\n    this.domElement = null\r\n    this.width = null\r\n    this.height = null\r\n    this.hasBattled = false\r\n  }\r\n  handleMovement(direction: keyof Movements): void {\r\n    let [left, top] = this.npcPositionOnDOM\r\n    const movements: Movements = {\r\n      up: () => top -= this.height,\r\n      down: () => top += this.height,\r\n      left: () => left -= this.width,\r\n      right: () => left += this.width\r\n    }\r\n    movements[direction]()\r\n    this.setNPCPositionOnDom(left, top)\r\n  }\r\n  ejectFromDom(): void {\r\n    this.domElement.remove()\r\n  }\r\n  faceTowardsPlayer(direction: keyof Movements) {\r\n    const oppositeDirections: object = {\r\n      up: 'down',\r\n      down: 'up',\r\n      left: 'right',\r\n      right: 'left'\r\n    }\r\n    this._currentFacingPosition = oppositeDirections[direction]\r\n    this.setFacingPosition()\r\n  }\r\n  get npcPositionOnDOM(): number[] {\r\n    const { left, top } = this.domElement.style\r\n    const newLeft = Number(left.substring(0, left.length - 2))\r\n    const newTop = Number(top.substring(0, top.length - 2))\r\n    return [newLeft, newTop]\r\n  }\r\n  setNPCPositionOnDom(x: number, y: number): void {\r\n    this.domElement.style.left = `${x}px`\r\n    this.domElement.style.top = `${y}px`\r\n  }\r\n  setFacingPositions() {\r\n    const { sheet } = this.sprite\r\n    this._npcFacingPositions = {\r\n      'up': sheet[1],\r\n      'down': sheet[0],\r\n      'right': sheet[3],\r\n      'left': sheet[2],\r\n    }\r\n  }\r\n  setFacingPosition(): void {\r\n    const [x, y] = this._npcFacingPositions[this._currentFacingPosition]\r\n    this.domElement.style.backgroundPosition = `${x}px ${y - 24}px`\r\n  }\r\n  createElement(): HTMLElement {\r\n    const element = document.createElement('div')\r\n    const { path, sheet, width, height } = this.sprite\r\n    const [[x, y]] = sheet\r\n    this.width = width\r\n    this.height = height\r\n    element.style.backgroundImage = `url('${path}')`\r\n    element.style.backgroundPosition = `${x}px ${y - 24}px`\r\n    element.style.backgroundRepeat = 'no-repeat'\r\n    element.style.width = `${width}px`\r\n    element.style.height = `${height}px`\r\n    element.style.position = 'absolute'\r\n    element.style.transition = 'left 500ms, top 500ms'\r\n    return element\r\n  }\r\n  setInitialPositionOnDom(x: number, y:number): void {\r\n    this.domElement.style.top = `${y}px`\r\n    this.domElement.style.left = `${x}px`\r\n  }\r\n  async init(startingPosition: Position, positionOnDOM: number[]): Promise<HTMLElement> {\r\n    this._position = startingPosition\r\n    const [x, y] = positionOnDOM\r\n    await this.sprite.init()\r\n    this.domElement = this.createElement()\r\n    this.setFacingPositions()\r\n    this.setFacingPosition()\r\n    this.setInitialPositionOnDom(x, y)\r\n    return this.domElement\r\n  }\r\n}\r\n","export class Delay {\r\n  static async delay(time: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, time))\r\n  }\r\n}\r\n","export class Screen {\r\n  private _root: HTMLElement\r\n  private _width: number\r\n  private _height: number\r\n  constructor(root: HTMLElement) {\r\n    this._root = root\r\n    this._width = 640\r\n    this._height = 384\r\n  }\r\n  adjustScreen({ currentTarget }: Event) {\r\n    const { innerHeight, innerWidth } = currentTarget as Window\r\n    const calculatedHeight = (innerHeight * .9) / this._height\r\n    const calculatedWidth = (innerWidth * .9) / this._width\r\n    this._root.style.transform = `scale(${calculatedHeight > calculatedWidth ? calculatedWidth : calculatedHeight})`\r\n  }\r\n  init() {\r\n    const { innerHeight, innerWidth } = window\r\n    const calculatedHeight = (innerHeight * .9) / this._height\r\n    const calculatedWidth = (innerWidth * .9) / this._width\r\n    this._root.style.transform = `scale(${calculatedHeight > calculatedWidth ? calculatedWidth : calculatedHeight})`\r\n    window.addEventListener('resize', this.adjustScreen.bind(this))\r\n  }\r\n}\r\n","import { Animator, Sprite, Task, TaskQueue } from '../helpers'\r\nimport { Observer } from './'\r\nimport { Levels, Movements, PlayerFacingPositions, Position, StoredBackgroundPositions } from '../interfaces'\r\n\r\nexport class Player extends Observer {\r\n  public sprite: Sprite\r\n  public animator: Animator\r\n  public domElement: HTMLElement\r\n  public width: number\r\n  public height: number\r\n  public getSceneTransition: Function\r\n  public isSpaceWalkable: Function\r\n  public isSceneTransition: Function\r\n  public isInteraction: Function\r\n  public getInteraction: Function\r\n  private _taskQueue: TaskQueue\r\n  private _position: Position\r\n  private _playerFacingPositions: PlayerFacingPositions\r\n  private _currentLevel: keyof Levels\r\n  private _storedBackgroundPositions: StoredBackgroundPositions\r\n  private _currentFacingPosition: keyof PlayerFacingPositions\r\n  constructor(\r\n    name: string,\r\n    path: string,\r\n    grid: number[],\r\n    taskQueue: TaskQueue,\r\n    currentLevel: keyof Levels,\r\n    isSceneTransition: Function,\r\n    getSceneTransition: Function,\r\n    isInteraction: Function,\r\n    getInteraction: Function,\r\n    isSpaceWalkable: Function\r\n  ) {\r\n    super()\r\n    this.sprite = new Sprite(name, path, grid)\r\n    this.animator = null\r\n    this.domElement = null\r\n    this.width = null\r\n    this.height = null\r\n    this._taskQueue = taskQueue\r\n    this._currentLevel = currentLevel\r\n    this._storedBackgroundPositions = {}\r\n    this._acceptedTasks = new Set(['movement', 'scene-transition-start', 'interaction'])\r\n    this._position = null\r\n    this._playerFacingPositions = null\r\n    this._currentFacingPosition = 'down'\r\n    this.getSceneTransition = getSceneTransition\r\n    this.isSpaceWalkable = isSpaceWalkable\r\n    this.isSceneTransition = isSceneTransition\r\n    this.isInteraction = isInteraction\r\n    this.getInteraction = getInteraction\r\n  }\r\n  handleUpdate({name, action}: Task): void {\r\n    if(!this._acceptedTasks.has(name)) return\r\n    switch(name) {\r\n      case 'movement':\r\n        this.handleMovement(action as keyof Movements)\r\n      break\r\n      case 'scene-transition-start':\r\n        this.handleSceneTransitionStart(action)\r\n      break\r\n      case 'interaction':\r\n        this.handleInteraction()\r\n      break\r\n    }\r\n  }\r\n  resetGym(): void {\r\n    [\r\n      'gymEntrance',\r\n      'gymArena1PreBattle',\r\n      'gymArena2PreBattle',\r\n      'gymArena3PreBattle',\r\n      'gymArena4PreBattle',\r\n      'gymArena5PreBattle',\r\n      'gymArena1PostBattle',\r\n      'gymArena2PostBattle',\r\n      'gymArena3PostBattle',\r\n      'gymArena4PostBattle',\r\n      'gymArena5PostBattle',\r\n      'gymArena6'\r\n    ].forEach(l => delete this._storedBackgroundPositions[l])\r\n  }\r\n  getTargetedPosition(direction: keyof Movements): Position {\r\n    const position: Position = { ...this._position }\r\n    const movements: Movements = {\r\n      up: p => p.y--,\r\n      down: p => p.y++,\r\n      left: p => p.x--,\r\n      right: p => p.x++\r\n    }\r\n    movements[direction](position)\r\n    return position\r\n  }\r\n  handleMovement(direction: keyof Movements): void {\r\n    const position = this.getTargetedPosition(direction)\r\n    const { x, y } = position\r\n    this.setFacingPosition(direction)\r\n    if(this.isSpaceWalkable(x, y)) {\r\n      this.animator.play(direction)\r\n      this._position = position\r\n      this.updatePositionOnDOM(direction)\r\n      if(this.isSceneTransition(x, y)) {\r\n        this._taskQueue.addTask(\r\n          new Task(\r\n            'scene-transition-start',\r\n            this.getSceneTransition(x, y)\r\n          )\r\n        )\r\n      }\r\n    } else {\r\n      this._taskQueue.addTask(new Task('wall-bump'))\r\n    }\r\n  }\r\n  handleSceneTransitionStart(action: any) {\r\n    this._storedBackgroundPositions[this._currentLevel] = this.playerPositionOnDOM\r\n    this._storedBackgroundPositions[this._currentLevel]\r\n    const {\r\n      playerPositionOnDOM,\r\n      playerPosition,\r\n      playerFacingPosition,\r\n      level\r\n    } = action\r\n    this._currentLevel = level\r\n    const [x, y] = this._storedBackgroundPositions[this._currentLevel]\r\n                    || playerPositionOnDOM\r\n    this.setFacingPosition(playerFacingPosition)\r\n    this._position = playerPosition\r\n    this.setPlayerPositionOnDom(x, y)\r\n    if(level === 'home') this.resetGym()\r\n  }\r\n  handleInteraction(): void {\r\n    const { x, y } = this.getTargetedPosition(this._currentFacingPosition)\r\n    if(!this.isInteraction(x, y)) return\r\n    const interaction = this.getInteraction(x, y)\r\n    this._taskQueue.addTask(new Task(\r\n      `${interaction.type}-interaction-start`,\r\n      {\r\n        playerFacingPosition: this._currentFacingPosition,\r\n        ...interaction\r\n      }\r\n    ))\r\n  }\r\n  updatePositionOnDOM(direction: keyof Movements): void {\r\n    let [ left, top ] = this.playerPositionOnDOM\r\n    const movements: Movements = {\r\n      up: () => top -= this.height,\r\n      down: () => top += this.height,\r\n      left: () => left -= this.width,\r\n      right: () => left += this.width\r\n    }\r\n    movements[direction]()\r\n    this.setPlayerPositionOnDom(left, top)\r\n  }\r\n  setFacingPosition(direction: keyof PlayerFacingPositions): void {\r\n    this._currentFacingPosition = direction\r\n    const [x, y] = this._playerFacingPositions[direction]\r\n    this.domElement.style.backgroundPosition = `${x}px ${y - 24}px`\r\n  }\r\n  get playerPositionOnDOM(): number[] {\r\n    const { left, top } = this.domElement.style\r\n    const newLeft = Number(left.substring(0, left.length - 2))\r\n    const newTop = Number(top.substring(0, top.length - 2))\r\n    return [newLeft, newTop]\r\n  }\r\n  setPlayerPositionOnDom(x: number, y:number): void {\r\n    this.domElement.style.left = `${x}px`\r\n    this.domElement.style.top = `${y}px`\r\n  }\r\n  setInitialPositionOnDom(): void {\r\n    const { x, y } = this._position\r\n    this.domElement.style.top = `${y * this.height}px`\r\n    this.domElement.style.left = `${x * this.width}px`\r\n  }\r\n  createElement(): HTMLElement {\r\n    const element = document.createElement('div')\r\n    const { path, sheet, width, height } = this.sprite\r\n    const [[x, y]] = sheet\r\n    this.width = width\r\n    this.height = height\r\n    element.style.backgroundImage = `url('${path}')`\r\n    element.style.backgroundPosition = `${x}px ${y - 24}px`\r\n    element.style.backgroundRepeat = 'no-repeat'\r\n    element.style.width = `${width}px`\r\n    element.style.height = `${height}px`\r\n    element.style.position = 'absolute'\r\n    element.style.transition = 'left 500ms, top 500ms'\r\n    return element\r\n  }\r\n  debug(x: number, y: number): void{\r\n    const element = document.createElement('div')\r\n    element.className = 'space'\r\n    element.dataset.x = x.toString()\r\n    element.dataset.y = y.toString()\r\n    element.style.top = `${y * this.height}px`\r\n    element.style.left = `${x * this.width}px`\r\n    document.getElementById('root').append(element)\r\n  }\r\n  createAnimations(): void {\r\n    const { sheet } = this.sprite\r\n    this.animator = new Animator(this.domElement)\r\n    this.animator.addAnimation(\r\n      'down',\r\n      [\r\n        sheet[1],\r\n        sheet[2],\r\n        sheet[0],\r\n      ],\r\n      50,\r\n    )\r\n    this.animator.addAnimation(\r\n      'up',\r\n      [\r\n        sheet[7],\r\n        sheet[8],\r\n        sheet[6],\r\n      ],\r\n      50,\r\n    )\r\n    this.animator.addAnimation(\r\n      'left',\r\n      [\r\n        sheet[13],\r\n        sheet[14],\r\n        sheet[12],\r\n      ],\r\n      50,\r\n    )\r\n    this.animator.addAnimation(\r\n      'right',\r\n      [\r\n        sheet[19],\r\n        sheet[20],\r\n        sheet[18],\r\n      ],\r\n      50,\r\n    )\r\n  }\r\n  setFacingPositions() {\r\n    const { sheet } = this.sprite\r\n    this._playerFacingPositions = {\r\n      'up': sheet[6],\r\n      'down': sheet[0],\r\n      'right': sheet[18],\r\n      'left': sheet[12],\r\n    }\r\n  }\r\n  async init(startingPosition: Position): Promise<HTMLElement> {\r\n    this._position = startingPosition\r\n    await this.sprite.init()\r\n    this.domElement = this.createElement()\r\n    this.setFacingPositions()\r\n    this.createAnimations()\r\n    this.setInitialPositionOnDom()\r\n    return this.domElement\r\n  }\r\n}\r\n","import { Sprite, Task, TaskQueue } from '../helpers'\r\nimport { Observer } from './'\r\nimport { Levels, Movements, Position, StoredBackgroundPositions } from '../interfaces'\r\nimport { Player } from './player'\r\n\r\nexport class Camera extends Observer {\r\n  private _visibleWidth: number\r\n  private _visibleHeight: number\r\n  private _collisionWidth: number\r\n  private _collisionHeight: number\r\n  private _playerBoundaries: number[]\r\n  private _isDebugMode: boolean\r\n  private _player: Player\r\n  private _backgroundElement: HTMLElement\r\n  private _cameraPosition: number[]\r\n  private _taskQueue: TaskQueue\r\n  private _currentLevel: keyof Levels\r\n  private _storedBackgroundPositions: StoredBackgroundPositions\r\n  public domElement: HTMLElement\r\n  constructor(\r\n    taskQueue: TaskQueue,\r\n    width: number,\r\n    height: number,\r\n    backgroundElement: HTMLElement,\r\n    currentLevel: keyof Levels,\r\n    isDebugMode: boolean = false\r\n  ) {\r\n    super()\r\n    this._taskQueue = taskQueue\r\n    this._storedBackgroundPositions = {}\r\n    this._currentLevel = currentLevel\r\n    this._acceptedTasks = new Set(['movement', 'scene-transition-start'])\r\n    this._visibleWidth = width\r\n    this._visibleHeight = height\r\n    this._collisionWidth = width / 10 * 8\r\n    this._collisionHeight = height / 10 * 6\r\n    this._playerBoundaries = [512, 96, 256, 128]\r\n    this._isDebugMode = isDebugMode\r\n    this._player = null\r\n    this._backgroundElement = backgroundElement\r\n    this._cameraPosition = [0, 0]\r\n    this.domElement = null\r\n  }\r\n  handleUpdate({ name, action }: Task): void {\r\n    switch (name) {\r\n      case 'movement':\r\n        this.handleMovement()\r\n      break\r\n      case 'scene-transition-start':\r\n        this.handleSceneTransitionStart(action)\r\n      break\r\n    }\r\n  }\r\n  resetGym(): void {\r\n    [\r\n      'gymEntrance',\r\n      'gymArena1PreBattle',\r\n      'gymArena2PreBattle',\r\n      'gymArena3PreBattle',\r\n      'gymArena4PreBattle',\r\n      'gymArena5PreBattle',\r\n      'gymArena1PostBattle',\r\n      'gymArena2PostBattle',\r\n      'gymArena3PostBattle',\r\n      'gymArena4PostBattle',\r\n      'gymArena5PostBattle',\r\n      'gymArena6',\r\n    ].forEach(l => delete this._storedBackgroundPositions[l])\r\n  }\r\n  handleMovement(): void {\r\n    const [ left, top ] = this._player.playerPositionOnDOM\r\n    const [ maxLeft, maxRight, maxTop, maxBottom] = this._playerBoundaries\r\n    let selectedMovement: keyof Movements = null\r\n    if(left > maxLeft) {\r\n      selectedMovement = 'left'\r\n    } else if(left < maxRight) {\r\n      selectedMovement = 'right'\r\n    } else if (top >= maxTop) {\r\n      selectedMovement = 'up'\r\n    } else if( top < maxBottom) {\r\n      selectedMovement = 'down'\r\n    }\r\n    if(!selectedMovement) return\r\n    this._player.updatePositionOnDOM(selectedMovement)\r\n    this.moveCamera(selectedMovement)\r\n    this._taskQueue.addTask(new Task('npc-movement', selectedMovement))\r\n  }\r\n  handleSceneTransitionStart(action: any) {\r\n    this._storedBackgroundPositions[this._currentLevel] = this.currentBackgroundPosition\r\n    const {\r\n      backgroundPositionOnDOM,\r\n      level\r\n    } = action\r\n    this._currentLevel = level\r\n    this._cameraPosition = this._storedBackgroundPositions[this._currentLevel]\r\n                            || backgroundPositionOnDOM\r\n    this.updatePositionOnDOM()\r\n    if(level === 'home') this.resetGym()\r\n  }\r\n  moveCamera(direction: keyof Movements): void {\r\n    const { width, height } = this._player\r\n    let [ x, y ] = this._cameraPosition\r\n    const movements: Movements = {\r\n      up: () => y -= height,\r\n      down: () => y += height,\r\n      left: () => x -= width,\r\n      right: () => x += width\r\n    }\r\n    movements[direction]()\r\n    this._cameraPosition = [ x, y ]\r\n    this.updatePositionOnDOM()\r\n  }\r\n  updatePositionOnDOM(): void {\r\n    const [x, y] = this._cameraPosition\r\n    this._backgroundElement.style.backgroundPosition = `${x}px ${y}px`\r\n  }\r\n  get currentBackgroundPosition(): number[] {\r\n    const { backgroundPositionX , backgroundPositionY } = this._backgroundElement.style\r\n    const x = Number(backgroundPositionX.substring(0, backgroundPositionX.length - 2))\r\n    const y = Number(backgroundPositionY.substring(0, backgroundPositionY.length - 2))\r\n    return [x, y]\r\n  }\r\n  createElement(): HTMLElement {\r\n    const element = document.createElement('div')\r\n    element.style.width = `${this._collisionWidth}px`\r\n    element.style.height = `${this._collisionHeight}px`\r\n    element.style.position = 'absolute'\r\n    if(this._isDebugMode) {\r\n      element.style.border = '2px solid red'\r\n      element.style.boxSizing = 'border-box'\r\n    }\r\n    return element\r\n  }\r\n  init(player: Player): HTMLElement {\r\n    this._player = player\r\n    this.domElement = this.createElement()\r\n    return this.domElement\r\n  }\r\n}\r\n","import home from './home.json'\r\nimport pokemonCenter from './pokemon-center.json'\r\nimport gymEntrance from './gym-entrance.json'\r\nimport battleTower from './battle-tower.json'\r\nimport lfzEntrance from './lfz-entrance.json'\r\nimport casino from './casino.json'\r\nimport casinoRoom from './casino-room.json'\r\nimport homeHouse1 from './home-house-1.json'\r\nimport homeHouse2 from './home-house-2.json'\r\nimport homeHouse3 from './home-house-3.json'\r\nimport gymArena1PreBattle from './gym-arena-1-pre-battle.json'\r\nimport gymArena2PreBattle from './gym-arena-2-pre-battle.json'\r\nimport gymArena3PreBattle from './gym-arena-3-pre-battle.json'\r\nimport gymArena4PreBattle from './gym-arena-4-pre-battle.json'\r\nimport gymArena5PreBattle from './gym-arena-5-pre-battle.json'\r\nimport gymArena1PostBattle from './gym-arena-1-post-battle.json'\r\nimport gymArena2PostBattle from './gym-arena-2-post-battle.json'\r\nimport gymArena3PostBattle from './gym-arena-3-post-battle.json'\r\nimport gymArena4PostBattle from './gym-arena-4-post-battle.json'\r\nimport gymArena5PostBattle from './gym-arena-5-post-battle.json'\r\nimport gymArena6 from './gym-arena-6.json'\r\nimport npcData from './npc.json'\r\nimport dialogueData from './dialogue.json'\r\nimport generalQuestions from './general-questions.json'\r\nimport battleData from './battle.json'\r\n\r\nconst levels = {\r\n  home,\r\n  pokemonCenter,\r\n  gymEntrance,\r\n  battleTower,\r\n  lfzEntrance,\r\n  casino,\r\n  casinoRoom,\r\n  homeHouse1,\r\n  homeHouse2,\r\n  homeHouse3,\r\n  gymArena1PreBattle,\r\n  gymArena2PreBattle,\r\n  gymArena3PreBattle,\r\n  gymArena4PreBattle,\r\n  gymArena5PreBattle,\r\n  gymArena1PostBattle,\r\n  gymArena2PostBattle,\r\n  gymArena3PostBattle,\r\n  gymArena4PostBattle,\r\n  gymArena5PostBattle,\r\n  gymArena6\r\n}\r\n\r\nexport {\r\n  levels,\r\n  npcData,\r\n  dialogueData,\r\n  battleData,\r\n  generalQuestions\r\n}\r\n","import { levels } from '../data'\r\nimport { Observer } from '.'\r\nimport { Task } from '../helpers'\r\nimport { Interaction, Position, SceneTransition, Tile } from '../interfaces'\r\n\r\nexport class Level extends Observer {\r\n  public root: HTMLElement\r\n  public name: string\r\n  public grid: any\r\n  constructor(name: string, root: HTMLElement, isDebugMode: boolean = false) {\r\n    super()\r\n    this._acceptedTasks = new Set(['scene-transition-start'])\r\n    this.root = root\r\n    this.name = name\r\n    this.grid = levels[name]\r\n    if(isDebugMode) {\r\n      this.triggerDebugView()\r\n    }\r\n  }\r\n  handleUpdate({ name, action}: Task): void {\r\n    switch(name) {\r\n      case 'scene-transition-start':\r\n        this.handleSceneTransitionStart(action)\r\n      break;\r\n    }\r\n  }\r\n  handleSceneTransitionStart(action: any) {\r\n    const {\r\n      level,\r\n    } = action\r\n    this.changeGrid(level)\r\n    const { path } = this.grid\r\n    this.changeMap(path)\r\n  }\r\n  getTile(x: number, y:number): Tile {\r\n    return this.grid[`${x}/${y}`]\r\n  }\r\n  getSceneTransition(x: number, y:number): SceneTransition {\r\n    return this.getTile(x, y).sceneTransition\r\n  }\r\n  getInteraction(x: number, y: number): Interaction {\r\n    return this.getTile(x, y).interaction\r\n  }\r\n  isSpaceWalkable(x: number, y: number): boolean {\r\n    if(!this.getTile(x, y)) return false\r\n    return this.getTile(x, y).isWalkable\r\n  }\r\n  isSceneTransition(x: number, y: number): boolean {\r\n    if (!this.getTile(x, y)) return false\r\n    return !!this.getTile(x, y).sceneTransition\r\n  }\r\n  isInteraction(x: number, y: number): boolean {\r\n    if (!this.getTile(x, y)) return false\r\n    return !!this.getTile(x, y).interaction\r\n  }\r\n  triggerDebugView(): void {\r\n    for(const tile in this.grid) {\r\n      const { x, y, isWalkable} = this.grid[tile]\r\n      const element = document.createElement('div')\r\n      element.className = 'space'\r\n      element.style.top = `${y * 64}px`\r\n      element.style.left = `${x * 32}px`\r\n      element.textContent = `${x}/${y}`\r\n      if(isWalkable) {\r\n        element.style.border = '2px solid green'\r\n      } else {\r\n        element.style.border = '2px solid red'\r\n      }\r\n      this.root.append(element)\r\n    }\r\n    this.root.style.width = '1920px'\r\n    this.root.style.height = '1280px'\r\n  }\r\n  changeMap(path: string): void {\r\n    this.root.style.backgroundImage = `url('${path}')`\r\n  }\r\n  changeGrid(gridName: string): void {\r\n    this.grid = levels[gridName]\r\n  }\r\n  shiftBackgroundPosition(x: number, y:number) {\r\n    this.root.style.backgroundPosition = `${x}px ${y}px`\r\n  }\r\n  async loadBackgroundImages(): Promise<void> {\r\n    const filePaths = Object.values(levels).map((l: any) => l.path)\r\n    await Promise.all(filePaths.map(path => {\r\n      return new Promise((resolve, reject) => {\r\n        const image = new Image()\r\n        image.onload = resolve\r\n        image.onerror = reject\r\n        image.src = path\r\n      })\r\n    }))\r\n  }\r\n  async init(): Promise<Position> {\r\n    await this.loadBackgroundImages()\r\n    const { path, playerSpawnPoint, backgroundSpawnPoint} = this.grid\r\n    const [x, y] = backgroundSpawnPoint\r\n    this.changeMap(path)\r\n    this.shiftBackgroundPosition(x, y)\r\n    return playerSpawnPoint\r\n  }\r\n}\r\n","import { Task, TaskQueue } from \"../helpers\";\r\nimport { KeyTable } from '../interfaces'\r\nimport { Observer } from \"./\";\r\nexport class Input extends Observer {\r\n  private _isDisabled: boolean\r\n  private _currentMode: keyof KeyTable\r\n  private _movementKeys: Set<string>\r\n  private _taskQueue: TaskQueue\r\n  private _keyTable: KeyTable\r\n  private _walkingInterval: number\r\n  private _isWalking: boolean\r\n  constructor(taskQueue: TaskQueue) {\r\n    super()\r\n    this._isDisabled = true\r\n    this._isWalking = false\r\n    this._acceptedTasks = new Set([\r\n      'npc-interaction-start',\r\n      'npc-interaction-end',\r\n      'scene-transition-start',\r\n      'scene-transition-end',\r\n      'battle-start',\r\n      'battle-navigate-answer',\r\n      'disable-input',\r\n      'enable-input',\r\n      'simulate-input',\r\n      'start-game'\r\n    ])\r\n    this._currentMode = 'loading'\r\n    this._taskQueue = taskQueue\r\n    this._movementKeys = new Set(['w', 'a', 's', 'd'])\r\n    this._keyTable = {\r\n      loading: {\r\n        ' ': ['start-game', null]\r\n      },\r\n      walking: {\r\n        'w': ['movement', 'up'],\r\n        'a': ['movement', 'left'],\r\n        's': ['movement', 'down'],\r\n        'd': ['movement', 'right'],\r\n        ' ': ['interaction', null],\r\n        'm': ['toggle-sound', null]\r\n      },\r\n      dialogue: {\r\n        ' ': ['dialogue', null],\r\n        'm': ['toggle-sound', null]\r\n      },\r\n      battle: {\r\n        'w': ['battle', 'selectPreviousAnswer'],\r\n        's': ['battle', 'selectNextAnswer'],\r\n        ' ': ['battle', null],\r\n        'm': ['toggle-sound', null]\r\n      }\r\n    }\r\n  }\r\n  get isDisabled(): boolean {\r\n    return this._isDisabled\r\n  }\r\n  set isDisabled(bool: boolean) {\r\n    this._isDisabled = bool\r\n  }\r\n  handleUpdate({ name, action }: Task): void {\r\n    switch (name) {\r\n      case 'scene-transition-start':\r\n        this.handleSceneTransitionStart()\r\n      break\r\n      case 'scene-transition-end':\r\n        this.handleSceneTransitionEnd()\r\n      break\r\n      case 'npc-interaction-start':\r\n        this.handleNPCInteractionStart()\r\n      break\r\n      case 'npc-interaction-end':\r\n        this.handleNPCInteractionEnd()\r\n      break\r\n      case 'battle-start':\r\n        this.handleBattleStart()\r\n      break\r\n      case 'battle-navigate-answer':\r\n        this.handleBattleNavigateAnswer()\r\n      break\r\n      case 'disable-input':\r\n        this.handleDisableInput()\r\n      break\r\n      case 'enable-input':\r\n        this.handleEnableInput()\r\n      break\r\n      case 'simulate-input':\r\n        this.handleSimulateInput(action)\r\n        break\r\n      case 'start-game':\r\n        this.handleStartGame()\r\n        break\r\n    }\r\n  }\r\n  handleStartGame(): void {\r\n    this._currentMode = 'walking'\r\n  }\r\n  handleSimulateInput(key: string) {\r\n    this.handleInput({ key } as KeyboardEvent)\r\n  }\r\n  handleDisableInput() {\r\n    this.isDisabled = true\r\n  }\r\n  handleEnableInput() {\r\n    this.isDisabled = false\r\n  }\r\n  handleBattleNavigateAnswer(): void {\r\n    this.isDisabled = false\r\n    this._currentMode = 'battle'\r\n  }\r\n  handleBattleStart() {\r\n    this.isDisabled = true\r\n  }\r\n  handleNPCInteractionEnd() {\r\n    this._currentMode = 'walking'\r\n  }\r\n  handleNPCInteractionStart(): void {\r\n    this._currentMode = 'dialogue'\r\n  }\r\n  handleSceneTransitionStart(): void {\r\n    this.isDisabled = true\r\n  }\r\n  handleSceneTransitionEnd(): void {\r\n    this.isDisabled = false\r\n  }\r\n  handleInput({ key }: KeyboardEvent): void {\r\n    if(this.isDisabled) return\r\n    const keyTable = this._keyTable[this._currentMode]\r\n    if(!keyTable[key]) return\r\n    const [ name, action ] = keyTable[key]\r\n    if(name === 'movement' && this._isWalking) return\r\n    this._taskQueue.addTask(new Task(name, action))\r\n    if (name === 'movement') this.startWalkingLoop(name, action)\r\n  }\r\n  handleWalkingLogic({ key }: KeyboardEvent) {\r\n    if(this._movementKeys.has(key)) {\r\n      this.stopWalkingLoop()\r\n    }\r\n  }\r\n  startWalkingLoop(name: any, action: any) {\r\n    this._isWalking = true\r\n    this._walkingInterval = window.setInterval(() => {\r\n      if(this.isDisabled) return this.stopWalkingLoop()\r\n      this._taskQueue.addTask(new Task(name, action))\r\n    }, 200)\r\n  }\r\n  stopWalkingLoop() {\r\n    clearInterval(this._walkingInterval)\r\n    this._isWalking = false\r\n  }\r\n  init(): void {\r\n    window.addEventListener('keydown', this.handleInput.bind(this))\r\n    window.addEventListener('keyup', this.handleWalkingLogic.bind(this))\r\n    this.isDisabled = false\r\n  }\r\n}\r\n","import { NPC, Sprite, Task } from '../helpers'\r\nimport { npcData } from '../data'\r\nimport { Observer } from './'\r\nimport { Movements, NPCList, Position, SceneTransition } from '../interfaces'\r\n\r\nexport class NPCManager extends Observer {\r\n  private _currentLevel: string\r\n  private _root: HTMLElement\r\n  private _npcs: NPCList\r\n  private npcData: any\r\n  constructor(\r\n    currentLevel: string,\r\n    root: HTMLElement\r\n  ) {\r\n    super()\r\n    this._root = root\r\n    this._currentLevel = currentLevel\r\n    this._npcs = {}\r\n    this.npcData = npcData[currentLevel]\r\n    this._acceptedTasks = new Set(['npc-movement', 'npc-interaction-start', 'scene-transition-start'])\r\n  }\r\n  get npcs(): NPC[] {\r\n    return this._npcs[this._currentLevel]\r\n  }\r\n  set npcs(npcs: NPC[]) {\r\n    this._npcs[this._currentLevel] = npcs\r\n  }\r\n  handleUpdate({name, action}: Task): void {\r\n    switch (name) {\r\n      case 'npc-movement':\r\n        this.handleNPCMovement(action as keyof Movements)\r\n      break\r\n      case 'npc-interaction-start':\r\n        this.handleNPCInteractionStart(action)\r\n      break\r\n      case 'scene-transition-start':\r\n        this.handleSceneTransitionStart(action)\r\n      break\r\n    }\r\n  }\r\n  resetGym(): void {\r\n    [\r\n      'gymEntrance',\r\n      'gymArena1PreBattle',\r\n      'gymArena2PreBattle',\r\n      'gymArena3PreBattle',\r\n      'gymArena4PreBattle',\r\n      'gymArena5PreBattle',\r\n      'gymArena1PostBattle',\r\n      'gymArena2PostBattle',\r\n      'gymArena3PostBattle',\r\n      'gymArena4PostBattle',\r\n      'gymArena5PostBattle',\r\n      'gymArena6'\r\n    ].forEach(l => delete this._npcs[l])\r\n  }\r\n  handleNPCInteractionStart(action: any): void {\r\n    const { name, playerFacingPosition } = action\r\n    const npc = this.npcs.find(npc => npc.name === name)\r\n    npc.faceTowardsPlayer(playerFacingPosition)\r\n  }\r\n  handleNPCMovement(direction: keyof Movements): void {\r\n    this.npcs.forEach(npc => npc.handleMovement(direction))\r\n  }\r\n  async handleSceneTransitionStart({ level }: SceneTransition): Promise<void> {\r\n    this.npcs.forEach(npc => npc.ejectFromDom())\r\n    this.switchLevel(level)\r\n    let npcElements = null\r\n    if(!this.npcs) {\r\n      npcElements = await this.init()\r\n    } else {\r\n      npcElements = this.npcs.map(npc => npc.domElement)\r\n    }\r\n    this._root.append(...npcElements)\r\n    if (level === 'home') this.resetGym()\r\n\r\n  }\r\n  switchLevel(newLevel: string) {\r\n    this.npcData = npcData[newLevel] || []\r\n    this._currentLevel = newLevel\r\n  }\r\n  async loadNPCImages(): Promise<void> {\r\n    const files = Object.values(npcData)\r\n    const filesCombined: {\r\n      path: string\r\n    }[] = []\r\n    files.forEach(f => filesCombined.push(...f))\r\n    const filePaths = filesCombined.map(n => n.path)\r\n    await Promise.all(filePaths.map(path => {\r\n      return new Promise((resolve, reject) => {\r\n        const image = new Image()\r\n        image.onload = resolve\r\n        image.onerror = reject\r\n        image.src = path\r\n      })\r\n    }))\r\n  }\r\n  async init(): Promise<Array<HTMLElement>> {\r\n    const npcs: NPC[] = []\r\n    const npcElements = []\r\n    for(let i = 0; i < this.npcData.length; i++) {\r\n      const { path, startingPosition, facingPosition, positionOnDOM, name } = this.npcData[i]\r\n      const npcData: NPC = new NPC(name, path, facingPosition)\r\n      const element = await npcData.init(startingPosition, positionOnDOM)\r\n      npcs.push(npcData)\r\n      npcElements.push(element)\r\n    }\r\n    this.npcs = npcs\r\n    return npcElements\r\n  }\r\n}\r\n","import { Task, TaskQueue } from '../helpers'\r\nimport { DialogueData, Interaction, Levels, SceneTransition } from '../interfaces'\r\nimport { Observer } from './'\r\nimport { dialogueData } from '../data'\r\n\r\nexport class Dialogue extends Observer {\r\n  private _currentLevel: keyof Levels\r\n  private _dialogues: {\r\n    hasBattled?: boolean\r\n    preBattle?: DialogueData[]\r\n    postBattle?: DialogueData[]\r\n  }\r\n  private _currentDialogue: DialogueData[]\r\n  private _taskQueue: TaskQueue\r\n  private _writingIntervalId: number\r\n  private _currentWritingText: string[]\r\n  public containerElement: HTMLElement\r\n  public headingElement: HTMLElement\r\n  public contentElement: HTMLElement\r\n  private _isShowing: boolean\r\n  constructor(taskQueue: TaskQueue, currentLevel: keyof Levels) {\r\n    super()\r\n    this._acceptedTasks = new Set(['npc-interaction-start', 'scene-transition-start', 'dialogue', 'npc-interaction-end', 'battle-start', 'npc-battle-end'])\r\n    this._currentLevel = currentLevel\r\n    this._currentDialogue = []\r\n    this._writingIntervalId = null\r\n    this._currentWritingText = []\r\n    this._taskQueue = taskQueue\r\n    this._dialogues = dialogueData[currentLevel]\r\n    this._isShowing = false\r\n    this.containerElement = null\r\n    this.headingElement = null\r\n    this.contentElement = null\r\n  }\r\n  handleUpdate({ name, action }: Task): void {\r\n    switch (name) {\r\n      case 'npc-interaction-start':\r\n        this.handleNPCInteractionStart(action)\r\n      break\r\n      case 'npc-interaction-end':\r\n        this.handleNPCInteractionEnd()\r\n        break\r\n      case 'scene-transition-start':\r\n        this.handleSceneTransitionStart(action)\r\n      break\r\n      case 'dialogue':\r\n        this.handleDialogue()\r\n      break\r\n      case 'battle-start':\r\n        this.handleNPCInteractionEnd()\r\n      break\r\n      case 'npc-battle-end':\r\n        this.handleNPCBattleEnd(action)\r\n      break\r\n    }\r\n  }\r\n  handleNPCBattleEnd({ name, level}: any): void {\r\n    dialogueData[level][name].hasBattled = true\r\n  }\r\n  handleNPCInteractionEnd() {\r\n    this.hide()\r\n    this.heading = ''\r\n    this.content = ''\r\n    this._currentWritingText = []\r\n  }\r\n  handleDialogue(): void {\r\n    if(this._currentWritingText.length) {\r\n      clearInterval(this._writingIntervalId)\r\n      this.content = this.content + this._currentWritingText.join('')\r\n      this._currentWritingText = []\r\n      return\r\n    }\r\n    const { text, isTrigger, type, action } = this._currentDialogue.shift()\r\n    if(isTrigger) {\r\n      if(Array.isArray(type) || Array.isArray(action)) {\r\n        action.forEach((a: any, i: number) => {\r\n          this._taskQueue.addTask(\r\n            new Task(\r\n              type[i],\r\n              a\r\n            )\r\n          )\r\n        })\r\n      } else {\r\n        this._taskQueue.addTask(\r\n          new Task(\r\n            type,\r\n            action || null\r\n          )\r\n        )\r\n      }\r\n      return\r\n    }\r\n    this._currentWritingText = text.split('')\r\n    this.writeText()\r\n  }\r\n  handleNPCInteractionStart(action: Interaction) {\r\n    const { name } = action\r\n    const dialogue = this._dialogues[name]\r\n    this._currentDialogue = [...dialogue.hasBattled ? dialogue.postBattle : dialogue.preBattle]\r\n    const { text } = this._currentDialogue.shift()\r\n    this.heading = name\r\n    this._currentWritingText = text.split('')\r\n    this.writeText()\r\n    this.show()\r\n  }\r\n  writeText() {\r\n    this.content = ''\r\n    this._writingIntervalId = window.setInterval(() => {\r\n      if(!this._currentWritingText.length) {\r\n        clearInterval(this._writingIntervalId)\r\n        return\r\n      }\r\n      const letter = this._currentWritingText.shift()\r\n      this.content = this.content + letter\r\n    }, 50)\r\n  }\r\n  handleSceneTransitionStart({ level }: SceneTransition): void{\r\n    this._dialogues = dialogueData[level]\r\n    this._currentLevel = level\r\n    // Edge case, in too deep, need bandaid :(\r\n    if (level === 'home') dialogueData.gymArena6.Uzair.hasBattled = false\r\n  }\r\n  show(): void {\r\n    this.isShowing = true\r\n  }\r\n  hide(): void {\r\n    this.isShowing = false\r\n  }\r\n  get isShowing(): boolean {\r\n    return this._isShowing\r\n  }\r\n  set isShowing(bool: boolean) {\r\n    this._isShowing = bool\r\n    if(this._isShowing) {\r\n      this.containerElement.style.bottom = '20px'\r\n      this.containerElement.style.opacity = '1'\r\n    } else {\r\n      this.containerElement.style.bottom = '-115px'\r\n      this.containerElement.style.opacity = '0'\r\n    }\r\n  }\r\n  set heading(text: string) {\r\n    this.headingElement.textContent = text\r\n  }\r\n  get content(): string {\r\n    return this.contentElement.textContent\r\n  }\r\n  set content(text: string) {\r\n    this.contentElement.textContent = text\r\n  }\r\n  createElement(): void {\r\n    const container = document.createElement('div')\r\n    container.style.width = '500px'\r\n    container.style.height = '120px'\r\n    container.style.bottom = '-115px'\r\n    container.style.opacity = '0'\r\n    container.style.position = 'absolute'\r\n    container.style.border = '6px solid rosybrown'\r\n    container.style.borderRadius = '6px'\r\n    container.style.backgroundColor = 'beige'\r\n    container.style.transition = 'bottom 300ms, opacity 300ms'\r\n    container.style.zIndex = '2'\r\n    const heading = document.createElement('div')\r\n    heading.style.fontSize = '18px'\r\n    heading.style.paddingLeft = '8px'\r\n    const headingLine = document.createElement('hr')\r\n    headingLine.style.margin = '2px 0'\r\n    const content = document.createElement('div')\r\n    content.style.padding = '0 8px'\r\n    container.append(\r\n      heading,\r\n      headingLine,\r\n      content\r\n    )\r\n    this.headingElement = heading\r\n    this.contentElement = content\r\n    this.containerElement = container\r\n  }\r\n  init(): HTMLElement {\r\n    this.createElement()\r\n    return this.containerElement\r\n  }\r\n}\r\n","export abstract class BattleComponent {\r\n  abstract show(): void\r\n  abstract hide(): void\r\n}\r\n","import { BattleComponent } from \".\"\r\nexport class HP extends BattleComponent{\r\n  private _health: number\r\n  private _damage: number\r\n  private _classBase: string\r\n  private _healthBarContainer: HTMLElement\r\n  private _movingPosition: string\r\n  private _isShowing: boolean\r\n  private _healthBar: HTMLElement\r\n  constructor(\r\n    isPlayer: boolean\r\n  ) {\r\n    super()\r\n    this._health = 100\r\n    this._damage = null\r\n    this._classBase = isPlayer ? 'player' : 'enemy'\r\n    this._movingPosition = isPlayer ? 'left' : 'right'\r\n    this._healthBarContainer = document.querySelector(`.${this._classBase}-health-bar-container`)\r\n    this._healthBar = <HTMLElement>this._healthBarContainer.firstElementChild\r\n    this._isShowing = false\r\n  }\r\n  setDamageCounter(damage: number) {\r\n    this._damage = damage\r\n  }\r\n  damage(): void {\r\n    if(this._health - this._damage < 0) {\r\n      this._health = 0\r\n      this._healthBar.style.height = this._health + '%'\r\n    } else {\r\n      this._health -= this._damage\r\n      this._healthBar.style.height = this._health + '%'\r\n    }\r\n  }\r\n  get isDead(): boolean {\r\n    return !this._health\r\n  }\r\n  get isLow(): boolean {\r\n    return this._health <= 10\r\n  }\r\n  get isShowing(): boolean {\r\n    return this._isShowing\r\n  }\r\n  set isShowing(bool: boolean) {\r\n    this._isShowing = bool\r\n    if (this._isShowing) {\r\n      this._healthBarContainer.style[this._movingPosition] = '2px'\r\n    } else {\r\n      this._healthBarContainer.style[this._movingPosition] = '-26px'\r\n    }\r\n  }\r\n  show() {\r\n    this.isShowing = true\r\n  }\r\n  hide() {\r\n    this.isShowing = false\r\n  }\r\n  reset(): void {\r\n    this._health = 100\r\n    this._healthBar.style.height = this._health + '%'\r\n  }\r\n}\r\n","import { BattleComponent } from \".\"\r\n\r\nexport abstract class UI extends BattleComponent {\r\n  private _classBase: string\r\n  public _uiContainer: HTMLElement\r\n  private _movingPosition: string\r\n  private _isShowing: boolean\r\n  constructor(isPlayer: boolean) {\r\n    super()\r\n    this._classBase = isPlayer ? 'player' : 'enemy'\r\n    this._movingPosition = isPlayer ? 'right' : 'left'\r\n    this._uiContainer = document.querySelector(`.${this._classBase}-ui`)\r\n    this._isShowing = false\r\n  }\r\n  get isShowing(): boolean {\r\n    return this._isShowing\r\n  }\r\n  set isShowing(bool: boolean) {\r\n    this._isShowing = bool\r\n    if(this._isShowing) {\r\n      this._uiContainer.style[this._movingPosition] = '2px'\r\n    } else {\r\n      this._uiContainer.style[this._movingPosition] = '-360px'\r\n    }\r\n  }\r\n  show() {\r\n    this.isShowing = true\r\n  }\r\n  hide() {\r\n    this.isShowing = false\r\n  }\r\n}\r\n","import { UI } from \".\";\r\n\r\nexport class PlayerUI extends UI {\r\n  private _answerElements: HTMLElement[]\r\n  private _selectedAnswer: number\r\n\r\n  constructor(isPlayer: boolean) {\r\n    super(isPlayer)\r\n    this._answerElements = [...this._uiContainer.querySelectorAll('[data-answer]') as any]\r\n    this._selectedAnswer = 0\r\n  }\r\n  setCorrect() {\r\n    this._answerElements[this._selectedAnswer].classList.add('correct')\r\n  }\r\n  setWrong() {\r\n    this._answerElements[this._selectedAnswer].classList.add('wrong')\r\n  }\r\n  resetSelection() {\r\n    this._answerElements.forEach(a => a.classList.remove('correct', 'wrong'))\r\n    this.removeSelectedClass()\r\n    this._selectedAnswer = 0\r\n    this.addSelectedClass()\r\n  }\r\n  setAnswers(answers: string[]) {\r\n    for(let i = 0; i < answers.length; i++) {\r\n      this._answerElements[i].textContent = answers[i]\r\n    }\r\n  }\r\n  get selectedAnswer(): number {\r\n    return this._selectedAnswer\r\n  }\r\n  selectNextAnswer() {\r\n    this.removeSelectedClass()\r\n    if(this._selectedAnswer + 1 === this._answerElements.length) {\r\n      this._selectedAnswer = 0\r\n    } else {\r\n      this._selectedAnswer++\r\n    }\r\n    this.addSelectedClass()\r\n  }\r\n  selectPreviousAnswer() {\r\n    this.removeSelectedClass()\r\n    if(this._selectedAnswer - 1 === -1) {\r\n      this._selectedAnswer = this._answerElements.length - 1\r\n    } else {\r\n      this._selectedAnswer--\r\n    }\r\n    this.addSelectedClass()\r\n  }\r\n  removeSelectedClass() {\r\n    this._answerElements[this._selectedAnswer].classList.remove('selected')\r\n  }\r\n  addSelectedClass() {\r\n    this._answerElements[this._selectedAnswer].classList.add('selected')\r\n  }\r\n}\r\n","import { UI } from \".\";\r\n\r\nexport class EnemyUI extends UI {\r\n  private _writingIntervalId: number\r\n  private _content: HTMLElement\r\n  constructor(isPlayer: boolean) {\r\n    super(isPlayer)\r\n    this._writingIntervalId = null\r\n    this._content = this._uiContainer.querySelector('.content')\r\n  }\r\n  async writeText(text: string): Promise<void> {\r\n    const message = text.split('')\r\n    return new Promise(resolve => {\r\n      this.content = ''\r\n      this._writingIntervalId = window.setInterval(() => {\r\n        if (!message.length) {\r\n          clearInterval(this._writingIntervalId)\r\n          return resolve()\r\n        }\r\n        const letter = message.shift()\r\n        this.content = this.content + letter\r\n      }, 50)\r\n    })\r\n  }\r\n  get content(): string {\r\n    return this._content.textContent\r\n  }\r\n  set content(text: string) {\r\n    this._content.textContent = text\r\n  }\r\n  reset(): void {\r\n    this.content = ''\r\n  }\r\n}\r\n","import { BattleComponent } from \".\"\r\n\r\nexport abstract class Fighter extends BattleComponent {\r\n  private _classBase: string\r\n  private _movingPosition: string[]\r\n  private _isShowing: boolean\r\n  public _characterContainer: HTMLElement\r\n  constructor(\r\n    isPlayer: boolean\r\n  ) {\r\n    super()\r\n    this._classBase = isPlayer ? 'player' : 'enemy'\r\n    this._characterContainer = document.querySelector(`.${this._classBase}`)\r\n    this._isShowing = false\r\n    this._movingPosition = isPlayer ? ['left', '64px'] : ['right', '96px']\r\n  }\r\n  async damage(): Promise<void> {\r\n    let blinks: number = 6\r\n    let intervalId: number = null\r\n    return new Promise(resolve => {\r\n      intervalId = window.setInterval(() => {\r\n        if(!blinks) {\r\n          clearInterval(intervalId)\r\n          return resolve()\r\n        }\r\n        this._characterContainer.style.opacity = (blinks % 2).toString()\r\n        blinks--\r\n      }, 100)\r\n    })\r\n  }\r\n  get isShowing(): boolean {\r\n    return this._isShowing\r\n  }\r\n  set isShowing(bool: boolean) {\r\n    this._isShowing = bool\r\n    const [position, value] = this._movingPosition\r\n    if (this._isShowing) {\r\n      this._characterContainer.style[position] = value\r\n    } else {\r\n      this._characterContainer.style[position] = '-128px'\r\n    }\r\n  }\r\n  show() {\r\n    this.isShowing = true\r\n  }\r\n  hide() {\r\n    this.isShowing = false\r\n  }\r\n}\r\n","import { Fighter } from \".\";\r\n\r\nexport class PlayerFighter extends Fighter {\r\n  constructor(\r\n    isPlayer: boolean\r\n  ) {\r\n    super(isPlayer)\r\n  }\r\n}\r\n","import { Fighter } from \".\";\r\nimport { Sprite } from \"../../helpers\";\r\n\r\nexport class EnemyFighter extends Fighter {\r\n  private _enemyBackgrounds: {\r\n    [key: string]: number[]\r\n  }\r\n  private _name: string\r\n  private _sprite: Sprite\r\n  private _selectedBackgroundPosition: number[];\r\n  private _fighterBackgrounds: {\r\n    [key: string]: number[]\r\n  };\r\n  constructor(\r\n    isPlayer: boolean\r\n  ) {\r\n    super(isPlayer)\r\n    this._name = null\r\n    this._selectedBackgroundPosition = null\r\n    this._sprite = new Sprite(\r\n      'fighter',\r\n      './assets/images/players/fighters.png',\r\n      [4, 4]\r\n    )\r\n    this._fighterBackgrounds = null\r\n    this._sprite.init()\r\n    .then(() => {\r\n      const { sheet } = this._sprite\r\n      const [\r\n        Brett,\r\n        Scott,\r\n        Christian,,\r\n        TimD,\r\n        Uzair,,,\r\n        TimH,\r\n        Sarah,,,\r\n        Cody,\r\n        Blake\r\n      ] = sheet\r\n      this._fighterBackgrounds = {\r\n        Brett,\r\n        Scott,\r\n        TimD,\r\n        Uzair,\r\n        TimH,\r\n        Cody,\r\n        Sarah,\r\n        Christian,\r\n        Blake\r\n      }\r\n    })\r\n  }\r\n  set(name: string): void {\r\n    this._name = name\r\n    this._selectedBackgroundPosition = this._fighterBackgrounds[name]\r\n    const [ x, y ] = this._selectedBackgroundPosition\r\n    this._characterContainer.style.backgroundPosition = `${x}px ${y}px`\r\n  }\r\n}\r\n","import { BattleComponent } from \".\"\r\n\r\nexport class BackDrop extends BattleComponent {\r\n  private _isShowing: boolean\r\n  private _backDropElement: HTMLElement\r\n  constructor() {\r\n    super()\r\n    this._isShowing = false\r\n    this._backDropElement = document.querySelector('.battle-arena-backdrop')\r\n  }\r\n  get isShowing(): boolean {\r\n    return this._isShowing\r\n  }\r\n  set isShowing(bool: boolean) {\r\n    this._isShowing = bool\r\n    this._backDropElement.style.opacity = Number(this._isShowing).toString()\r\n  }\r\n  show() {\r\n    this.isShowing = true\r\n  }\r\n  hide() {\r\n    this.isShowing = false\r\n  }\r\n}\r\n","import { Sprite } from \"../../helpers\"\r\nimport { BattleComponent } from \".\"\r\n\r\nexport class Arena extends BattleComponent {\r\n  private _isShowing: boolean\r\n  private _arenaElement: HTMLElement\r\n  private _sprite: Sprite\r\n  private _selectedBackgroundPosition: number[]\r\n  private _arenaBackgrounds: {\r\n    [key: string]: number[]\r\n  }\r\n  constructor() {\r\n    super()\r\n    this._isShowing = false\r\n    this._arenaElement = document.querySelector('.battle-arena-container')\r\n    this._selectedBackgroundPosition = null\r\n    this._sprite = new Sprite(\r\n      'background',\r\n      './assets/images/maps/battle-backgrounds.png',\r\n      [3, 4]\r\n    )\r\n    this._arenaBackgrounds = null\r\n    this._sprite.init()\r\n    .then(() => {\r\n      const { sheet } = this._sprite\r\n      const [\r\n        normal,\r\n        rock,\r\n        dirt,\r\n        ghost,\r\n        grass,\r\n        water,\r\n        psychic,\r\n        ,\r\n        ocean,\r\n        ice,\r\n        plant\r\n      ] = sheet\r\n      this._arenaBackgrounds = {\r\n        normal,\r\n        rock,\r\n        dirt,\r\n        ghost,\r\n        grass,\r\n        water,\r\n        psychic,\r\n        ocean,\r\n        ice,\r\n        plant\r\n      }\r\n    })\r\n  }\r\n  set(arena: string): void {\r\n    this._selectedBackgroundPosition = this._arenaBackgrounds[arena]\r\n    const [x, y] = this._selectedBackgroundPosition\r\n    this._arenaElement.style.backgroundPosition = `${x}px ${y}px`\r\n  }\r\n  get isShowing(): boolean {\r\n    return this._isShowing\r\n  }\r\n  set isShowing(bool: boolean) {\r\n    this._isShowing = bool\r\n    this._arenaElement.style.opacity = Number(this._isShowing).toString()\r\n  }\r\n  show() {\r\n    this.isShowing = true\r\n  }\r\n  hide() {\r\n    this.isShowing = false\r\n  }\r\n}\r\n","import { Battle } from './battle'\r\n\r\nexport * from './battle-component'\r\nexport * from './hp'\r\nexport * from './ui'\r\nexport * from './player-ui'\r\nexport * from './enemy-ui'\r\nexport * from './fighter'\r\nexport * from './player-fighter'\r\nexport * from './enemy-fighter'\r\nexport * from './backdrop'\r\nexport * from './arena'\r\nexport default Battle\r\n","import { Delay, Task, TaskQueue } from '../../helpers'\r\nimport { Observer } from '../'\r\nimport { battleData, generalQuestions } from '../../data'\r\nimport { BattleComponents, BattleData, Levels, Question, QuestionData } from '../../interfaces'\r\nimport {\r\n  Arena,\r\n  BackDrop,\r\n  EnemyFighter,\r\n  EnemyUI,\r\n  PlayerFighter,\r\n  PlayerUI,\r\n  HP\r\n} from '.'\r\n\r\nexport class Battle extends Observer {\r\n  private _taskQueue: TaskQueue\r\n  private _currentLevel: keyof Levels\r\n  private _currentQuestions: Question[]\r\n  private _currentQuestion: Question\r\n  private _currentLevelQuestionData: {\r\n    [key: string]: QuestionData\r\n  }\r\n  private _selectedQuestionData: QuestionData\r\n  private _battleData: BattleData\r\n  private _battleComponents: BattleComponents\r\n  constructor(taskQueue: TaskQueue, currentLevel: keyof Levels) {\r\n    super()\r\n    this._acceptedTasks = new Set(['scene-transition-start', 'battle-start', 'battle-end', 'battle'])\r\n    this._currentLevel = currentLevel\r\n    this._taskQueue = taskQueue\r\n    this._battleData = battleData\r\n    this._currentLevelQuestionData = battleData[currentLevel]\r\n    this._currentQuestions = null\r\n    this._selectedQuestionData = null\r\n    this._battleComponents = {\r\n      arena: new Arena(),\r\n      backdrop: new BackDrop(),\r\n      enemyFighter: new EnemyFighter(false),\r\n      enemyUI: new EnemyUI(false),\r\n      playerFighter: new PlayerFighter(true),\r\n      playerUI: new PlayerUI(true),\r\n      playerHP: new HP(true),\r\n      enemyHP: new HP(false)\r\n    }\r\n  }\r\n  handleUpdate({ name, action }: Task): void {\r\n    switch (name) {\r\n      case 'battle-start':\r\n        this.handleBattleStart(action)\r\n        break\r\n      case 'battle-end':\r\n        this.handleBattleEnd(action)\r\n        break\r\n      case 'scene-transition-start':\r\n        this.handleSceneTransitionStart(action)\r\n        break;\r\n      case 'battle':\r\n        this.handleBattle(action)\r\n        break;\r\n    }\r\n  }\r\n  async handleBattleEnd(wasLoss: boolean): Promise<void> {\r\n    await Delay.delay(500)\r\n    for (const component in this._battleComponents) {\r\n      this._battleComponents[component].hide()\r\n    }\r\n    await Delay.delay(500)\r\n    const { playerUI, enemyUI, playerHP, enemyHP } = this._battleComponents\r\n    playerUI.resetSelection()\r\n    enemyUI.reset()\r\n    playerHP.reset()\r\n    enemyHP.reset()\r\n    this._taskQueue.addTask(\r\n      new Task('npc-interaction-end')\r\n    )\r\n    this._taskQueue.addTask(\r\n      new Task('enable-input')\r\n    )\r\n    if(!wasLoss) {\r\n      this._taskQueue.addTask(new Task('simulate-input', ' '))\r\n    }\r\n  }\r\n  async handleBattle(action: any): Promise<void> {\r\n    if(!action) {\r\n      this._taskQueue.addTask(\r\n        new Task('disable-input')\r\n      )\r\n      const { playerUI, enemyUI, playerHP, enemyHP, playerFighter, enemyFighter } = this._battleComponents\r\n      const isCorrect = playerUI.selectedAnswer === this._currentQuestion.correct\r\n      this._currentQuestion = this._currentQuestions.shift()\r\n\r\n      isCorrect\r\n      ? playerUI.setCorrect()\r\n      : playerUI.setWrong()\r\n      await Delay.delay(500)\r\n      this._taskQueue.addTask(new Task('battle-damage'))\r\n      if(isCorrect) {\r\n        enemyHP.damage()\r\n        await enemyFighter.damage()\r\n      } else {\r\n        playerHP.damage()\r\n        await playerFighter.damage()\r\n      }\r\n      await Delay.delay(500)\r\n      playerUI.hide()\r\n      await Delay.delay(500)\r\n      if(playerHP.isDead || enemyHP.isDead) {\r\n        const {\r\n        winningMessage,\r\n        losingMessage,\r\n        onWin,\r\n        onLoss\r\n        } = this._selectedQuestionData\r\n        const message = playerHP.isDead\r\n        ? losingMessage\r\n        : winningMessage\r\n        await enemyUI.writeText(message)\r\n        await Delay.delay(500)\r\n        if(playerHP.isDead) {\r\n          const { name, action } = onLoss\r\n          if(name || action) this._taskQueue.addTask(new Task(name, action))\r\n        } else {\r\n          const { name, action } = onWin\r\n          this._taskQueue.addTask(new Task(name, action))\r\n        }\r\n        this._taskQueue.addTask(new Task('battle-end', playerHP.isDead))\r\n        return\r\n      }\r\n      if(playerHP.isLow || enemyHP.isLow) {\r\n        this._taskQueue.addTask(new Task('battle-health-low'))\r\n      }\r\n      playerUI.resetSelection()\r\n      playerUI.setAnswers(this._currentQuestion.answers)\r\n      await enemyUI.writeText(this._currentQuestion.question)\r\n      await Delay.delay(500)\r\n      playerUI.show()\r\n      this._taskQueue.addTask(\r\n        new Task(\r\n          'enable-input'\r\n        )\r\n      )\r\n    } else {\r\n      this._battleComponents.playerUI[action]()\r\n    }\r\n  }\r\n  handleSceneTransitionStart({ level }: any): void {\r\n    this._currentLevel = level\r\n    this._currentLevelQuestionData = battleData[level]\r\n  }\r\n  async handleBattleStart({ fighter }: any): Promise<void> {\r\n    if (!this._currentLevelQuestionData) throw new Error('Missing questions for this map.')\r\n    this._selectedQuestionData = this._currentLevelQuestionData[fighter]\r\n    if (!this._selectedQuestionData) throw new Error('Missing questions for this fighter.')\r\n    this._currentQuestions = this._selectedQuestionData.questions\r\n    ? [...this._selectedQuestionData.questions]\r\n    : [...generalQuestions]\r\n    this.shuffleQuestions()\r\n    this._currentQuestion = this._currentQuestions.shift()\r\n    const  {\r\n      arena,\r\n      backdrop,\r\n      enemyFighter,\r\n      enemyUI,\r\n      playerFighter,\r\n      playerUI,\r\n      playerHP,\r\n      enemyHP\r\n    } = this._battleComponents\r\n    const {\r\n      arena: background,\r\n      name,\r\n      sprite,\r\n      damageToEnemy,\r\n      damageToPlayer,\r\n      title,\r\n      openingMessage,\r\n    } = this._selectedQuestionData\r\n    arena.set(background)\r\n    enemyFighter.set(sprite)\r\n    enemyHP.setDamageCounter(damageToEnemy)\r\n    playerHP.setDamageCounter(damageToPlayer)\r\n    playerUI.setAnswers(this._currentQuestion.answers)\r\n    backdrop.show()\r\n    await Delay.delay(500)\r\n    arena.show()\r\n    await Delay.delay(500)\r\n    playerFighter.show()\r\n    enemyFighter.show()\r\n    await Delay.delay(500)\r\n    enemyUI.show()\r\n    await Delay.delay(500)\r\n    await enemyUI.writeText(`${title} ${name} challenges you to a battle!`)\r\n    await Delay.delay(500)\r\n    playerHP.show()\r\n    enemyHP.show()\r\n    await Delay.delay(500)\r\n    await enemyUI.writeText(openingMessage)\r\n    await Delay.delay(1000)\r\n    await enemyUI.writeText(this._currentQuestion.question)\r\n    await Delay.delay(500)\r\n    playerUI.show()\r\n    this._taskQueue.addTask(\r\n      new Task(\r\n        'battle-navigate-answer',\r\n        null\r\n      )\r\n    )\r\n  }\r\n  shuffleQuestions(): void {\r\n    for(let i = 0; i < this._currentQuestions.length; i++) {\r\n      const randomNum = Math.floor(Math.random() * this._currentQuestions.length)\r\n      const placeHolder = this._currentQuestions[i]\r\n      this._currentQuestions[i] = this._currentQuestions[randomNum]\r\n      this._currentQuestions[randomNum] = placeHolder\r\n    }\r\n  }\r\n  // writeText() {\r\n  //   this.content = ''\r\n  //   this._writingIntervalId = window.setInterval(() => {\r\n  //     if (!this._currentWritingText.length) {\r\n  //       clearInterval(this._writingIntervalId)\r\n  //       return\r\n  //     }\r\n  //     const letter = this._currentWritingText.shift()\r\n  //     this.content = this.content + letter\r\n  //   }, 50)\r\n  // }\r\n  loadPlayerUI(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  beginQuestion(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  loadHealthBars(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  showOpeningMessage(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  showStartingMessage(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  loadEnemyUI(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  loadInCharacters(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  setupBattleBackground(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n  setupBackdrop(): void {\r\n    throw new Error('Method not implemented.')\r\n  }\r\n}\r\n","import { Observer } from './'\nimport { Delay, Task, TaskQueue } from '../helpers'\n\nexport class Transition extends Observer {\n  private _domElement: HTMLElement\n  private _taskQueue: TaskQueue\n  constructor(taskQueue: TaskQueue) {\n    super()\n    this._acceptedTasks = new Set(['scene-transition-start', 'scene-transition-end', 'start-game'])\n    this._domElement = document.getElementById('transition')\n    this._taskQueue = taskQueue\n  }\n  handleUpdate({ name }: Task): void {\n    switch (name) {\n      case 'scene-transition-start':\n        this.handleSceneTransitionStart()\n      break;\n      case 'scene-transition-end':\n        this.handleSceneTransitionEnd()\n      break;\n      case 'start-game':\n        this.handleStartGame()\n      break;\n    }\n  }\n  handleStartGame() {\n    this.hide()\n  }\n  async handleSceneTransitionStart() {\n    this.show()\n    await Delay.delay(1000)\n    this._taskQueue.addTask(\n      new Task(\n        'scene-transition-end',\n        null\n      )\n    )\n  }\n  handleSceneTransitionEnd() {\n    this.hide()\n  }\n  show(): void {\n    this._domElement.style.opacity = '1'\n  }\n  hide(): void {\n    this._domElement.style.opacity = '0'\n  }\n}\n","import { Observer } from './'\nimport { Delay, Task, TaskQueue } from '../helpers'\nimport { Levels, SoundFile } from '../interfaces'\n\nexport class Sound extends Observer {\n  private _path: string\n  private _sounds : {\n    [key: string]: HTMLAudioElement\n  }\n  private _isMuted: boolean\n  private _currentLevel: string\n  constructor(currentLevel: string) {\n    super()\n    this._acceptedTasks = new Set([\n      'toggle-sound',\n      'start-game',\n      'scene-transition-start',\n      'battle-health-low',\n      'battle-damage',\n      'battle-end',\n      'battle-start',\n      'interaction',\n      'dialogue',\n      'battle',\n      'wall-bump'\n    ])\n    this._path = './assets/audio/'\n    this._sounds = null\n    this._isMuted = true\n    this._currentLevel = currentLevel\n  }\n  get isMuted(): boolean {\n    return this._isMuted\n  }\n  set isMuted(bool: boolean) {\n    this._isMuted = bool\n    for (const key in this._sounds) {\n      this._sounds[key].volume = this._isMuted ? 0 : .2\n    }\n  }\n  stopAllSounds(): void {\n    for(const key in this._sounds) {\n      this._sounds[key].pause()\n      this._sounds[key].currentTime = 0\n    }\n  }\n  handleUpdate({ name, action }: Task): void {\n    switch (name) {\n      case 'start-game':\n        this.handleStartGame()\n      break;\n      case 'toggle-sound':\n        this.handleToggleSound()\n      break;\n      case 'scene-transition-start':\n        this.handleSceneTransitionStart(action)\n      break;\n      case 'battle-start':\n        this.handleBattleStart()\n      break;\n      case 'battle-damage':\n        this.handleBattleDamage()\n      break;\n      case 'battle-end':\n        this.handleBattleEnd()\n        break;\n      case 'battle-health-low':\n        this.handleBattleHealthLow()\n      break;\n      case 'interaction':\n      case 'dialogue':\n      case 'battle':\n        this.handleSelect()\n      break;\n      case 'wall-bump':\n        this.handleWallBump()\n      break;\n      }\n    }\n  handleStartGame(): void {\n    this.playMapSound(this._currentLevel)\n  }\n  handleWallBump(): void {\n    this._sounds.wall.play()\n  }\n  handleSelect(): void {\n    this._sounds.select.currentTime = 0\n    this._sounds.select.play()\n  }\n  handleBattleEnd(): void {\n    this.stopAllSounds()\n    this.playMapSound(this._currentLevel)\n  }\n  handleBattleDamage(): void {\n    this._sounds.battleDamage.play()\n  }\n  handleBattleHealthLow(): void {\n    this._sounds.lowHealth.play()\n  }\n  handleBattleStart(): void {\n    this.stopAllSounds()\n    let sound = null\n    switch (this._currentLevel) {\n      case 'gymArena1PreBattle':\n      case 'gymArena2PreBattle':\n      case 'gymArena3PreBattle':\n      case 'gymArena4PreBattle':\n        sound = 'gymBattle'\n      break\n      case 'gymArena5PreBattle':\n        sound = 'gymArena5Battle'\n      break\n      case 'gymArena6':\n        sound = 'gymArena6Battle'\n      break\n      default:\n        sound = 'battleStart'\n      break\n    }\n    this._sounds[sound].play()\n  }\n  handleToggleSound(): void {\n    this.isMuted = !this.isMuted\n  }\n  playMapSound(level: string) {\n    let sound = null\n    switch(level) {\n      case 'pokemonCenter':\n        sound = 'pokemonCenter'\n      break\n      case 'home':\n        sound = 'home'\n      break\n      case 'battleTower':\n        sound = 'battleTower'\n      break\n      case 'lfzEntrance':\n        sound = 'lfzEntrance'\n      break\n      case 'gymEntrance':\n      case 'gymArena1PreBattle':\n      case 'gymArena2PreBattle':\n      case 'gymArena3PreBattle':\n      case 'gymArena4PreBattle':\n      case 'gymArena1PostBattle':\n      case 'gymArena2PostBattle':\n      case 'gymArena3PostBattle':\n      case 'gymArena4PostBattle':\n        sound = 'gym'\n      break\n      case 'gymArena5PostBattle':\n      case 'gymArena6':\n        sound = 'gymArena6'\n      break\n      case 'casino':\n      case 'casinoRoom':\n        sound = 'casino'\n      break\n    }\n    this._sounds[sound] && this._sounds[sound].play()\n  }\n  async handleSceneTransitionStart({ level }: any): Promise<void> {\n    this._currentLevel = level\n    if ([\n      'gymArena1PostBattle',\n      'gymArena2PostBattle',\n      'gymArena3PostBattle',\n      'gymArena4PostBattle',\n      'gymArena5PostBattle'\n    ].some(l => l === level)) return\n    this.stopAllSounds()\n    this._sounds.doorEnter.play()\n    await Delay.delay(500)\n    this.playMapSound(level)\n  }\n  async loadSound(\n    file: string,\n    key:string,\n    isLooping: boolean\n    ): Promise<{[key: string]: HTMLAudioElement}> {\n    return new Promise((resolve, reject) => {\n      const audio = new Audio()\n      audio.volume = 0\n      audio.loop = isLooping\n      audio.onloadeddata = () => resolve({[key]: audio})\n      audio.onerror = () => reject()\n      audio.src = file\n    })\n  }\n  async init(): Promise<void> {\n    const soundFiles: SoundFile[] = [\n      {\n        key: 'doorEnter',\n        file: 'door-enter.mp3',\n        isLooping: false\n      },\n      {\n        key: 'lowHealth',\n        file: 'low-health.mp3',\n        isLooping: false\n      },\n      {\n        key: 'battleDamage',\n        file: 'battle-damage.mp3',\n        isLooping: false\n      },\n      {\n        key: 'battleStart',\n        file: 'battle-start.mp3',\n        isLooping: true\n      },\n      {\n        key: 'pokemonCenter',\n        file: 'pokemon-center.mp3',\n        isLooping: true\n      },\n      {\n        key: 'select',\n        file: 'select.mp3',\n        isLooping: false\n      },\n      {\n        key: 'wall',\n        file: 'wall.mp3',\n        isLooping: false\n      },\n      {\n        key: 'home',\n        file: 'home.mp3',\n        isLooping: true\n      },\n      // HEER\n      {\n        key: 'battleTower',\n        file: 'battle-tower.mp3',\n        isLooping: true\n      },\n      {\n        key: 'casino',\n        file: 'casino.mp3',\n        isLooping: true\n      },\n      {\n        key: 'gymArena5Battle',\n        file: 'gym-arena-5-battle.mp3',\n        isLooping: true\n      },\n      {\n        key: 'gymArena6Battle',\n        file: 'gym-arena-6-battle.mp3',\n        isLooping: true\n      },\n      {\n        key: 'gymArena6',\n        file: 'gym-arena-6.mp3',\n        isLooping: true\n      },\n      {\n        key: 'gymBattle',\n        file: 'gym-battle.mp3',\n        isLooping: true\n      },\n      {\n        key: 'gym',\n        file: 'gym.mp3',\n        isLooping: true\n      },\n      {\n        key: 'lfzEntrance',\n        file: 'lfz-entrance.mp3',\n        isLooping: true\n      }\n    ]\n   const sounds = await Promise.all(soundFiles.map(({key, file, isLooping}) => (\n     this.loadSound(`${this._path}${file}`, key, isLooping)\n   )))\n   this._sounds = sounds.reduce((all, sound) => ({ ...all, ...sound }))\n  }\n}\n","import { Observer } from \".\"\nimport { Task } from \"../helpers\"\n\nexport class LoadingScreen extends Observer {\n  private _container: HTMLElement\n  private _message: HTMLElement\n  constructor() {\n    super()\n    this._acceptedTasks = new Set(['start-game'])\n    this._container = document.getElementById('loading-screen')\n    this._message = <HTMLElement>this._container.firstElementChild\n  }\n  handleUpdate({ name }: Task): void {\n    switch(name) {\n      case 'start-game':\n        this.handleStartGame()\n      break;\n    }\n  }\n  handleStartGame(): void {\n    this.hide()\n  }\n  get message (): string {\n    return this._message.textContent\n  }\n  set message(text: string) {\n    this._message.textContent = text\n  }\n  show() {\n    this._container.style.opacity = '1'\n  }\n  hide() {\n    this._container.style.opacity = '0'\n  }\n}\n","import Game from \"./game\";\r\n\r\nconst game = new Game()\r\n\r\ngame.start()\r\n","import Engine from './engine'\r\nimport { Camera, Player, Level, Input, NPCManager, Dialogue, Transition, Sound, LoadingScreen } from './entities'\r\nimport Battle from './entities/battle'\r\nimport { TaskQueue, Screen } from './helpers'\r\n\r\nexport default class Game {\r\n  $root: HTMLElement\r\n  engine: Engine\r\n  input: Input\r\n  taskQueue: TaskQueue\r\n  loadingScreen: LoadingScreen\r\n  level: Level\r\n  npcManager: NPCManager\r\n  dialogue: Dialogue\r\n  camera: Camera\r\n  player: Player\r\n  battle: Battle\r\n  transition: Transition\r\n  sound: Sound\r\n  screen: Screen\r\n  constructor() {\r\n    this.$root = document.getElementById('root')\r\n    this.taskQueue = new TaskQueue()\r\n    this.loadingScreen = new LoadingScreen()\r\n    this.engine = new Engine(this.taskQueue)\r\n    this.level = new Level('home', this.$root)\r\n    this.npcManager = new NPCManager('home', this.$root)\r\n    this.camera = new Camera(this.taskQueue, 640, 384, this.$root, 'home')\r\n    this.dialogue = new Dialogue(this.taskQueue, 'home')\r\n    this.battle = new Battle(this.taskQueue, 'home')\r\n    this.player = new Player(\r\n      'MC',\r\n      './assets/images/players/player.png',\r\n      [4, 6],\r\n      this.taskQueue,\r\n      'home',\r\n      this.level.isSceneTransition.bind(this.level),\r\n      this.level.getSceneTransition.bind(this.level),\r\n      this.level.isInteraction.bind(this.level),\r\n      this.level.getInteraction.bind(this.level),\r\n      this.level.isSpaceWalkable.bind(this.level)\r\n    )\r\n    this.input = new Input(this.taskQueue)\r\n    this.transition = new Transition(this.taskQueue)\r\n    this.sound = new Sound('home')\r\n    this.screen = new Screen(this.$root)\r\n  }\r\n  setupDOM(...args: Array<HTMLElement>) {\r\n    this.$root.append(...args)\r\n  }\r\n  async start(): Promise<void> {\r\n    this.screen.init()\r\n    this.loadingScreen.message = 'Loading Maps...'\r\n    const playerSpawnPoint = await this.level.init()\r\n    this.loadingScreen.message = 'Loading Player...'\r\n    const playerElement = await this.player.init(playerSpawnPoint)\r\n    this.loadingScreen.message = 'Loading NPCs...'\r\n    await this.npcManager.loadNPCImages()\r\n    const npcElements = await this.npcManager.init()\r\n    this.loadingScreen.message = 'Loading Sounds...'\r\n    await this.sound.init()\r\n    this.loadingScreen.message = 'Loading Game...'\r\n    const cameraElement = this.camera.init(this.player)\r\n    const dialogueElement = this.dialogue.init()\r\n    this.setupDOM(playerElement, cameraElement, dialogueElement,...npcElements)\r\n    this.engine.addObserver(this.transition)\r\n    this.engine.addObserver(this.sound)\r\n    this.engine.addObserver(this.camera)\r\n    this.engine.addObserver(this.battle)\r\n    this.engine.addObserver(this.player)\r\n    this.engine.addObserver(this.dialogue)\r\n    this.engine.addObserver(this.npcManager)\r\n    this.engine.addObserver(this.level)\r\n    this.engine.addObserver(this.input)\r\n    this.engine.addObserver(this.loadingScreen)\r\n    this.engine.start()\r\n    this.input.init()\r\n    this.loadingScreen.message = 'Press Space to Start'\r\n  }\r\n}\r\n"],"sourceRoot":""}